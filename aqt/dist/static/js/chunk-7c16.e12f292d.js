(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7c16"],{Epr7:function(e,t,i){"use strict";var o=i("FNiH");i.n(o).a},FNiH:function(e,t,i){},q4Ke:function(e,t,i){"use strict";i.r(t);var o=i("Q2AE");var a=i("wk8/"),s={props:{email:{type:String,required:!0}},data:function(){var e=this;return{loading:!1,dialog:!1,title:"修改邮箱",form:{pass:"",email:"",code:""},user:{email:"",password:""},codeLoading:!1,codeData:{type:"email",value:""},buttonName:"获取验证码",isDisabled:!1,time:60,rules:{pass:[{required:!0,validator:function(e,t,i){Object(a.l)(t).then(function(e){200===e.code?i():i(new Error("密码错误，请重新输入"))})},trigger:"blur"}],email:[{required:!0,validator:function(t,i,o){""===i?o(new Error("新邮箱不能为空")):i===e.email?o(new Error("新邮箱不能与旧邮箱相同")):function(e){return/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test(e)}(i)?o():o(new Error("邮箱格式错误"))},trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"}]}}},methods:{cancel:function(){this.resetForm()},sendCode:function(){var e=this;if(this.form.email&&this.form.email!==this.email){this.codeLoading=!0,this.buttonName="验证码发送中",this.codeData.value=this.form.email;var t=this;Object(a.h)(this.form.email).then(function(i){e.$message({showClose:!0,message:"发送成功，验证码有效期5分钟",type:"success"}),e.codeLoading=!1,e.isDisabled=!0,e.buttonName=e.time--+"秒后重新发送",e.timer=window.setInterval(function(){t.buttonName=t.time+"秒后重新发送",--t.time,t.time<0&&(t.buttonName="重新发送",t.time=60,t.isDisabled=!1,window.clearInterval(t.timer))},1e3)}).catch(function(t){e.codeLoading=!1,console.log(t.msg)})}},doSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;e.loading=!0,e.user={email:e.form.email,password:e.form.pass},Object(a.j)(e.form.code,e.form.email,e.form.pass).then(function(t){e.loading=!1,e.resetForm(),e.$notify({title:"邮箱修改成功",type:"success",duration:1500}),o.a.dispatch("GetInfo").then(function(){})}).catch(function(t){e.loading=!1,console.log(t.response.data.message)})})},resetForm:function(){this.dialog=!1,this.$refs.form.resetFields(),window.clearInterval(this.timer),this.time=60,this.buttonName="获取验证码",this.isDisabled=!1,this.form={pass:"",email:"",code:""}}}},r=(i("Epr7"),i("KHd+")),l=Object(r.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{display:"inline-block"}},[i("el-button",{staticClass:"button",attrs:{size:"mini",type:"info"},on:{click:function(t){e.dialog=!0}}},[e._v("修改")]),e._v(" "),i("el-dialog",{attrs:{visible:e.dialog,title:e.title,width:"475px"},on:{"update:visible":function(t){e.dialog=t},close:e.cancel}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,size:"small","label-width":"88px"}},[i("el-form-item",{attrs:{label:"新邮箱",prop:"email"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{"auto-complete":"on"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}}),e._v(" "),i("el-button",{attrs:{loading:e.codeLoading,disabled:e.isDisabled,size:"small"},on:{click:e.sendCode}},[e._v(e._s(e.buttonName))])],1),e._v(" "),i("el-form-item",{attrs:{label:"验证码",prop:"code"}},[i("el-input",{staticStyle:{width:"320px"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"当前密码",prop:"pass"}},[i("el-input",{staticStyle:{width:"320px"},attrs:{type:"password"},model:{value:e.form.pass,callback:function(t){e.$set(e.form,"pass",t)},expression:"form.pass"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"text"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.doSubmit}},[e._v("确认")])],1)],1)],1)},[],!1,null,"b8dad754",null);l.options.__file="updateEmail.vue";t.default=l.exports}}]);